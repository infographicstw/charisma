var x$;x$=angular.module("main",[]),x$.controller("main",["$scope","$http"].concat(function(e,n){return plotdb.load("chart/charisma.json",function(n){return e.$apply(function(){return e.chart=n,e.fetch()})}),e.fetch=function(){var t;return t=["https://spreadsheets.google.com/feeds/list/","16fmW_tXYocbRe6oASbemINxF1nJ9ECYRU4gZiHdXF5g","/2/public/values?alt=json"].join(""),n({url:t,method:"GET"}).success(function(n){function t(){var e=[];for(f in s)e.push(f);return e}function r(){return/^gsx\$/.exec(f)}function a(e){var n,t;return(n=/^(\d)\./.exec(s[e].$t))?(t=n[1],l[t]=(l[t]||0)+1):void 0}var c,o,i,u,s,l,f,d;for(c=[],o=0,u=(i=n.feed.entry).length;u>o;++o)s=i[o],l={},t().filter(r).map(a),c.push({gender:s["gsx$我的性別"].$t,name:s["gsx$我的名字"].$t,wisdom:l[1],passion:l[2],instinct:l[3]});return console.log(c.length+" entries fetched"),d={name:[{name:"name",data:c.map(function(e){return e.name})}],category:[{name:"gender",data:c.map(function(e){return e.gender})}],value1:[{name:"wisdom",data:c.map(function(e){return e.wisdom})}],value2:[{name:"passion",data:c.map(function(e){return e.passion})}],value3:[{name:"instinct",data:c.map(function(e){return e.instinct})}]},e.chart.config({}),e.chart.data(d),e.chart.attach(document.getElementById("ternary")),e.doSearch?(e.doSearch=!1,e._search()):void 0}).error(function(){})},e.root=d3.select("#ternary"),e.setActive=function(){return e.root.selectAll("circle").attr({display:function(n){return e.active&&n.category!==["全部","男","女","其它"][e.active]?"none":"block"}})},e.$watch("active",function(){return e.setActive()}),e._search=function(){return e.root.selectAll("circle").attr({display:function(n){return n.name.indexOf(e.name)>=0?"block":"none"}})},e.clear=function(){return e.setActive()},e.search=function(){return e.doSearch=!0,e.refresh(),e.root.selectAll("circle").attr({display:function(n){return n.name.indexOf(e.name)>=0?"block":"none"}})},e.clear=function(){return e.setActive()},e.refresh=function(){return e.fetch()}}));